<html>
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script type="text/javascript">
        var add_url = "https://4547fey8hf.execute-api.us-east-1.amazonaws.com/beta/calculator";

        function processResponse(card) {
        // Can grab any DIV or SPAN HTML element and can then manipulate its
        // contents dynamically via javascript
        console.log("card: " + card);
        var js = JSON.parse(card);

        var computation = js["card"];

        // Update computation result
        document.addForm.result.value = computation
        }

        function createCard(e) {
            var form = document.addForm;
            var eventType = form.eventType.value;
            var recipient = form.recipient.value;
            var orientation = form.orientation.value;

            if(!eventType && !recipient && !orientation) {
                return;
            }

            var data = {};
            data["eventType"] = eventType;
            data["recipient"] = recipient;
            data["orientation"] = orientation;

            var js = JSON.stringify(data);
            console.log("JS:" + js);
            var xhr = new XMLHttpRequest();
            xhr.open("POST", add_url, true);

            // send the collected data as JSON
            xhr.send(js);

            // This will process results and update HTML as appropriate. 
            xhr.onloadend = function () {
                console.log(xhr);
                console.log(xhr.request);
                if (xhr.readyState == XMLHttpRequest.DONE) {
                    if (xhr.status == 200) {
                    console.log ("XHR:" + xhr.responseText);
                    processResponse(arg1, arg2, xhr.responseText);
                    } else if (xhr.status == 400) {
                        alert ("unable to process request");
                    }
                } else {
                processResponse(arg1, arg2, "N/A");
                }
            };
        }
    </script>
</head>

<body>
    <h1>Card Maker</h1>

    <div>
        <h2>List of Cards</h2> 
        <div>
            <select id="cardList" size="10">
            	<option>Please load from Database</option>
            </select>
            <br>
            <button type="button" id="listBtn" name="listBtn">List All Card from Database</button>
            <br>
            <button type="button" id="deleteBtn" name="deleteBtn">Delete Selected Card</button>
        </div>
    </div>

    <div>
        <h2>Create a card</h2>
        <form name="createCardForm" method="post" name="createCard">
            Event Type: <input name="eventType" value="" />
            <br>
            Recipient: <input name="recipient" value=""/>
            <br>
            Orientation: 
            <select name="orientation">
            	<option>Landscape</option>
            	<option>Portrait</option>
            </select>
            <br>
            <input type="button" value="Create"  onClick="JavaScript:createCard(this)">
        </form>
    </div>
</body>
</html>